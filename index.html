<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8" />
    <title>Ø¬Ø¯ÙˆÙ„ Ø£Ø³Ø¨ÙˆØ¹ÙŠ Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„ØªÙˆØªØ±</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="shortcut icon" href="images/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/style.css" />
</head>

<body class="bg-light">
    <div class="container py-4 bg-white rounded shadow">
        <h2 class="text-center fw-bold mb-3">
            <i class="fas fa-brain text-primary"></i> Ø¬Ø¯ÙˆÙ„ Ø£Ø³Ø¨ÙˆØ¹ÙŠ Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„ØªÙˆØªØ±
        </h2>
        <p class="text-center mb-4" id="dateTime"></p>

        <div class="table-responsive">
            <table class="table table-bordered text-center align-middle" id="stressTable">
                <thead class="table-primary">
                    <tr>
                        <th>Ø§Ù„ÙŠÙˆÙ…</th>
                        <th>Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹</th>
                        <th>Ø§Ù„Ù‡Ø¯Ù</th>
                        <th>ÙÙƒØ±Ø© Ø§Ù„Ø­Ù„</th>
                        <th>Ø§Ù„Ù…Ø¯Ø©</th>
                        <th>ØªÙ… Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²ØŸ</th>
                        <th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <div class="text-center mt-4">
            <button class="btn btn-success" onclick="saveWeekData()"><i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</button>
            <button class="btn btn-info" onclick="showAllReports()"><i class="fas fa-chart-line"></i> Ø¹Ø±Ø¶
                Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
            <button class="btn btn-danger" onclick="newWeek()"><i class="fas fa-sync"></i> Ø¨Ø¯Ø¡ Ø£Ø³Ø¨ÙˆØ¹ Ø¬Ø¯ÙŠØ¯</button>
        </div>

        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ø®ØªÙŠØ§Ø± ØªÙ‚Ø±ÙŠØ± Ù…Ø­Ø¯Ø¯ -->
        <div class="text-center my-4">
            <select id="reportSelector" class="form-select d-inline w-auto">
                <option selected disabled>Ø§Ø®ØªØ± ØªÙ‚Ø±ÙŠØ± Ø£Ø³Ø¨ÙˆØ¹...</option>
            </select>
            <button class="btn btn-secondary ms-2" onclick="showSpecificReport()">
                <i class="fas fa-eye"></i> Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø­Ø¯Ø¯
            </button>
        </div>

        <div class="mt-4" id="reportsSection"></div>
    </div>

    <!-- Modals -->
    <div class="modal fade" id="ideaModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-start">
                <div class="modal-header">
                    <h5 class="modal-title">ØªÙØ§ØµÙŠÙ„ ÙÙƒØ±Ø© Ø§Ù„Ø­Ù„</h5>
                    <button type="button" class="btn-close mr_style" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="ideaModalContent"></div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-bs-dismiss="modal">Ø¥ØºÙ„Ø§Ù‚</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="noteModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-start">
                <div class="modal-header">
                    <h5 class="modal-title">âœï¸ Ø£Ø¶Ù / Ø¹Ø¯Ù‘Ù„ Ù…Ù„Ø§Ø­Ø¸ØªÙƒ</h5>
                    <button type="button" class="btn-close mr_style" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <textarea id="modalNoteInput" class="form-control" rows="4"
                        placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸ØªÙƒ Ù‡Ù†Ø§..."></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="button" class="btn btn-primary" onclick="saveNote()">Ø­ÙØ¸</button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/bootstrap.bundle.min.js"></script>
    <script>
        const weekData = [
            { day: "Ø§Ù„Ø³Ø¨Øª", topic: "ÙÙ‡Ù… Ø§Ù„ØªÙˆØªØ±", goal: "Ù…Ø¹Ø±ÙØ© Ø£Ø³Ø¨Ø§Ø¨Ù‡", idea: "Ø§Ø¨Ø­Ø« Ø¹Ù† ÙÙŠØ¯ÙŠÙˆ Ø¹Ù† Ø§Ù„ØªÙˆØªØ±", ideaDetails: "Ø§Ø¨Ø­Ø« Ø¹Ù† ÙÙŠØ¯ÙŠÙˆ ÙŠØ´Ø±Ø­ Ø§Ù„ØªÙˆØªØ± ÙˆØªØ£Ø«ÙŠØ±Ù‡.", start: "10:00", end: "10:30" },
            { day: "Ø§Ù„Ø£Ø­Ø¯", topic: "ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙˆØªØ±", goal: "ØªØ­Ø¯ÙŠØ¯ Ù…Ø³Ø¨Ø¨Ø§ØªÙ‡", idea: "Ø§ÙƒØªØ¨ Ø£Ø³Ø¨Ø§Ø¨Ùƒ", ideaDetails: "Ø§ÙƒØªØ¨ Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„ØªÙˆØªØ± Ø§Ù„ØªÙŠ ØªÙˆØ§Ø¬Ù‡Ù‡Ø§.", start: "12:00", end: "12:20" },
            { day: "Ø§Ù„Ø§Ø«Ù†ÙŠÙ†", topic: "ØªÙ…Ø§Ø±ÙŠÙ† ØªÙ†ÙØ³", goal: "Ø®ÙØ¶ Ø§Ù„ØªÙˆØªØ±", idea: "ØªÙ‚Ù†ÙŠØ© 4-7-8", ideaDetails: "Ø´Ù‡ÙŠÙ‚ 4 Ø«ÙˆØ§Ù†ØŒ Ø­Ø¨Ø³ Ø§Ù„Ù†ÙØ³ 7ØŒ Ø²ÙÙŠØ± 8.", start: "3:00", end: "3:20" },
            { day: "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", topic: "Ø§Ù„ØªØ£Ù…Ù„", goal: "Ø§Ù„Ù‡Ø¯ÙˆØ¡ Ø§Ù„Ø°Ù‡Ù†ÙŠ", idea: "ØªØ·Ø¨ÙŠÙ‚ ØªØ£Ù…Ù„", ideaDetails: "Ø§Ø³ØªØ®Ø¯Ù… ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù…Ø«Ù„ Headspace Ø£Ùˆ Calm.", start: "6:00", end: "6:20" },
            { day: "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡", topic: "Ø­Ø¯ÙŠØ« Ø¥ÙŠØ¬Ø§Ø¨ÙŠ", goal: "Ø±ÙØ¹ Ø§Ù„Ù…Ø¹Ù†ÙˆÙŠØ§Øª", idea: "Ø¹Ø¨Ø§Ø±Ø§Øª ØªØ­ÙÙŠØ²ÙŠØ©", ideaDetails: "Ø±Ø¯Ù‘Ø¯ Ø¹Ø¨Ø§Ø±Ø§Øª ØªØ­ÙÙŠØ²ÙŠØ© ØµØ¨Ø§Ø­Ù‹Ø§ ÙˆÙ…Ø³Ø§Ø¡Ù‹.", start: "7:00", end: "7:20" },
            { day: "Ø§Ù„Ø®Ù…ÙŠØ³", topic: "Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ø®ØªØ¨Ø§Ø±", goal: "Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù‚Ù„Ù‚", idea: "Ø£Ø³Ø¦Ù„Ø© ØªØ¯Ø±ÙŠØ¨ÙŠØ©", ideaDetails: "Ø¬Ø§ÙˆØ¨ Ø¹Ù„Ù‰ Ø£Ø³Ø¦Ù„Ø© ØªØ¯Ø±ÙŠØ¨ÙŠØ© ÙƒØ£Ù†Ùƒ ÙÙŠ Ø§Ù…ØªØ­Ø§Ù†.", start: "9:00", end: "9:20" },
            { day: "Ø§Ù„Ø¬Ù…Ø¹Ø©", topic: "Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹", goal: "Ù‚ÙŠØ§Ø³ Ø§Ù„ØªÙ‚Ø¯Ù…", idea: "Ø§ÙƒØªØ¨ Ù…Ø§ ØªØ¹Ù„Ù…Øª", ideaDetails: "Ù‚ÙŠÙ‘Ù… Ø¥Ù†Ø¬Ø§Ø²Ø§ØªÙƒ Ø®Ù„Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹.", start: "10:00", end: "10:20" }
        ];

        let noteIndex = null;

        function getDateKey() {
            const d = new Date();
            return `${d.getFullYear()}-${d.getMonth() + 1}-${d.getDate()}`;
        }

        function formatTime(timeStr) {
            const [hour, minute] = timeStr.split(":").map(Number);
            const ampm = hour >= 12 ? "Ù…Ø³Ø§Ø¡Ù‹" : "ØµØ¨Ø§Ø­Ù‹Ø§";
            const h = hour % 12 || 12;
            return `${h}:${minute.toString().padStart(2, "0")} ${ampm}`;
        }

        function loadTable() {
            const tbody = document.querySelector("#stressTable tbody");
            tbody.innerHTML = "";
            for (let i = 0; i < weekData.length; i++) {
                tbody.innerHTML += `
    <tr>
      <td>${weekData[i].day}</td>
      <td>${weekData[i].topic}</td>
      <td>${weekData[i].goal}</td>
      <td><button class="btn btn-link text-primary p-0" onclick="showIdeaModal(${i})"><i class="fas fa-lightbulb"></i> ${weekData[i].idea}</button></td>
      <td>Ù…Ù† ${formatTime(weekData[i].start)} Ø¥Ù„Ù‰ ${formatTime(weekData[i].end)}</td>
      <td><input type="checkbox" class="form-check-input checkbox_style" id="check${i}"></td>
      <td class="w_style">
        <div id="noteText${i}" class="note-text text-muted mb-1">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¨Ø¹Ø¯</div>
        <button class="btn btn-outline-primary btn-sm" onclick="openModal(${i})">âœï¸ Ø£Ø¶Ù / Ø¹Ø¯Ù‘Ù„ Ù…Ù„Ø§Ø­Ø¸Ø©</button>
      </td>
    </tr>`;
            }
        }

        function openModal(i) {
            noteIndex = i;
            document.getElementById("modalNoteInput").value = "";
            new bootstrap.Modal(document.getElementById("noteModal")).show();
        }

        function saveNote() {
            const text = document.getElementById("modalNoteInput").value.trim();
            if (!text || noteIndex === null) return;
            const noteBox = document.getElementById(`noteText${noteIndex}`);

            if (noteBox.innerText.trim() === "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¨Ø¹Ø¯") {
                noteBox.innerHTML = "";
            }

            const oldNotes = noteBox.querySelectorAll('.note-content');
            oldNotes.forEach(note => {
                note.classList.remove('text-success');
                note.classList.add('text-danger');
            });

            const newNote = document.createElement("span");
            newNote.className = "d-block text-success note-content d-flex justify-content-between align-items-center mt-1";
            newNote.innerHTML = `
    <span>${text}</span>
    <button class="btn btn-sm btn-danger py-0 px-2" onclick="removeNote(this)">ğŸ—‘ï¸</button>`;
            noteBox.appendChild(newNote);
            bootstrap.Modal.getInstance(document.getElementById("noteModal")).hide();
            document.getElementById("modalNoteInput").value = "";
        }

        function removeNote(button) {
            const noteSpan = button.closest("span");
            const noteBox = noteSpan.parentElement;
            noteSpan.remove();
            if (!noteBox.querySelector('.note-content')) {
                noteBox.innerHTML = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¨Ø¹Ø¯';
            }
        }

        function saveWeekData() {
            const key = "weekReport_" + getDateKey();
            const data = [];
            for (let i = 0; i < weekData.length; i++) {
                data.push({
                    day: weekData[i].day,
                    goal: weekData[i].goal,
                    idea: weekData[i].idea,
                    start: weekData[i].start,
                    end: weekData[i].end,
                    done: document.getElementById("check" + i).checked,
                    note: document.getElementById("noteText" + i).innerText.trim()
                });
            }
            localStorage.setItem(key, JSON.stringify(data));
            alert("âœ… ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹.");
            populateReportSelector();
        }

        function showAllReports() {
            document.getElementById("reportsSection").innerHTML = "";
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith("weekReport_")) {
                    const saved = JSON.parse(localStorage.getItem(key));
                    showReport(saved, key.replace("weekReport_", ""));
                }
            }
        }

        function showReport(saved, label) {
            const report = `
            <div class="border rounded p-3 bg-light mb-4">
                <h5><i class="fas fa-table text-secondary"></i> ØªÙ‚Ø±ÙŠØ±: ${label}</h5>
                <div class="d-flex justify-content-between mb-2">
                    <button class="btn btn-outline-dark btn-sm print_style" onclick="printThis(this)">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
                    <button class="btn btn-outline-danger btn-sm print_style" onclick="this.closest('.border').remove()">ğŸ—‘ï¸ Ø¥Ø®ÙØ§Ø¡ Ù…Ù† Ø§Ù„Ø¹Ø±Ø¶</button>
                </div>
                <div class="table-responsive">
                    <table class="table table-bordered text-center mt-2">
                        <thead class="table-secondary">
                            <tr><th>Ø§Ù„ÙŠÙˆÙ…</th><th>Ø§Ù„Ù‡Ø¯Ù</th><th>Ø§Ù„ÙÙƒØ±Ø©</th><th>Ø§Ù„Ù…Ø¯Ø©</th><th>Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</th><th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th></tr>
                        </thead>
                        <tbody>
                            ${saved.map(r => `
                                <tr>
                                    <td>${r.day}</td>
                                    <td>${r.goal}</td>
                                    <td>${r.idea}</td>
                                    <td>Ù…Ù† ${formatTime(r.start)} Ø¥Ù„Ù‰ ${formatTime(r.end)}</td>
                                    <td>${r.done ? 'âœ…' : 'âŒ'}</td>
                                    <td>${r.note || '-'}</td>
                                </tr>`).join("")}
                        </tbody>
                    </table>
                </div>
            </div>`;
            document.getElementById("reportsSection").innerHTML += report;
        }

        function showSpecificReport() {
            const key = document.getElementById("reportSelector").value;
            if (!key) return alert("âš ï¸ Ø§Ø®ØªØ± ØªÙ‚Ø±ÙŠØ± Ø£ÙˆÙ„Ù‹Ø§");
            const saved = JSON.parse(localStorage.getItem(key));
            showReport(saved, key.replace("weekReport_", ""));
        }

        function printThis(button) {
            button.style.display = 'none';
            window.print();
            setTimeout(() => (button.style.display = 'inline-block'), 1000);
        }

        function newWeek() {
            loadTable();
        }

        function showIdeaModal(index) {
            document.getElementById("ideaModalContent").innerHTML = `<p>${weekData[index].ideaDetails}</p>`;
            new bootstrap.Modal(document.getElementById("ideaModal")).show();
        }

        function showDateTime() {
            const now = new Date();
            let hours = now.getHours();
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const ampm = hours >= 12 ? 'Ù…Ø³Ø§Ø¡Ù‹' : 'ØµØ¨Ø§Ø­Ù‹Ø§';
            hours = hours % 12 || 12;
            const time = `${hours}:${minutes} ${ampm}`;
            const days = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø§Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Ø§Ù„Ø³Ø¨Øª'];
            const months = ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ', 'ÙŠÙˆÙ„ÙŠÙˆ', 'Ø£ØºØ³Ø·Ø³', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'];
            const dateStr = `${days[now.getDay()]} ${now.getDate()} ${months[now.getMonth()]} ${now.getFullYear()} - ${time}`;
            document.getElementById("dateTime").textContent = dateStr;
        }

        function populateReportSelector() {
            const selector = document.getElementById("reportSelector");
            selector.innerHTML = `<option selected disabled>Ø§Ø®ØªØ± ØªÙ‚Ø±ÙŠØ± Ø£Ø³Ø¨ÙˆØ¹...</option>`;
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith("weekReport_")) {
                    const date = key.replace("weekReport_", "");
                    const option = document.createElement("option");
                    option.value = key;
                    option.textContent = date;
                    selector.appendChild(option);
                }
            }
        }

        // ØªØ´ØºÙŠÙ„ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        loadTable();
        showDateTime();
        setInterval(showDateTime, 1000);
        showAllReports();
        populateReportSelector();
    </script>

</body>

</html>